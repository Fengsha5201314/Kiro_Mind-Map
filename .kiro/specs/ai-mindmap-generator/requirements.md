# 需求文档

## 简介

AI思维导图生成器是一个Web应用程序，能够将各种格式的内容（文本、文档、PDF等）智能转换为可视化的思维导图。系统集成Gemini 3.0 AI能力，提供全中文界面，帮助用户快速理解和组织信息。

## 术语表

- **系统（System）**: AI思维导图生成器Web应用程序
- **用户（User）**: 使用本系统创建和查看思维导图的人
- **思维导图（MindMap）**: 以树状结构展示信息层次关系的可视化图表
- **节点（Node）**: 思维导图中的单个信息单元
- **Gemini API**: Google提供的生成式AI服务接口
- **API密钥（API Key）**: 用于访问Gemini API的认证凭证
- **内容解析（Content Parsing）**: 从输入文件中提取文本内容的过程
- **AI生成（AI Generation）**: 使用Gemini API将内容转换为思维导图结构的过程

## 需求

### 需求 1

**用户故事：** 作为用户，我想要上传或粘贴内容并生成思维导图，以便快速理解和组织信息。

#### 验收标准

1. WHEN 用户访问主页 THEN 系统应显示内容输入界面，包含文件上传区域和文本输入框
2. WHEN 用户上传PDF文件 THEN 系统应提取文件中的文本内容并保存到处理队列
3. WHEN 用户上传Word文档（.doc/.docx） THEN 系统应提取文档中的文本内容并保存到处理队列
4. WHEN 用户上传Markdown文件（.md） THEN 系统应提取文件中的文本内容并保存到处理队列
5. WHEN 用户上传纯文本文件（.txt） THEN 系统应读取文件内容并保存到处理队列
6. WHEN 用户在文本框中粘贴内容 THEN 系统应接受该文本内容并保存到处理队列
7. WHEN 用户提交空内容 THEN 系统应阻止提交并显示错误提示信息

### 需求 2

**用户故事：** 作为用户，我想要配置Gemini API密钥，以便系统能够使用AI功能生成思维导图。

#### 验收标准

1. WHEN 用户访问设置页面 THEN 系统应显示API密钥配置界面
2. WHEN 用户输入有效的API密钥并保存 THEN 系统应将密钥加密存储到本地存储
3. WHEN 用户输入的API密钥为空 THEN 系统应阻止保存并显示错误提示
4. WHEN 用户已保存API密钥 THEN 系统应在设置页面显示密钥的掩码版本（例如：sk-***abc）
5. WHEN 用户删除已保存的API密钥 THEN 系统应从本地存储中移除该密钥

### 需求 3

**用户故事：** 作为用户，我想要系统使用AI将内容转换为思维导图结构，以便自动提取关键信息和层次关系。

#### 验收标准

1. WHEN 用户点击生成按钮且已配置API密钥 THEN 系统应调用Gemini API处理内容
2. WHEN 系统调用Gemini API THEN 系统应发送包含内容和结构化提示词的请求
3. WHEN Gemini API返回结构化数据 THEN 系统应解析响应并转换为思维导图数据结构
4. WHEN API调用失败 THEN 系统应捕获错误并向用户显示友好的错误消息
5. WHEN 用户未配置API密钥就尝试生成 THEN 系统应阻止操作并提示用户先配置API密钥
6. WHEN 内容超过API限制 THEN 系统应将内容分段处理或提示用户缩减内容

### 需求 4

**用户故事：** 作为用户，我想要在画布上查看和交互思维导图，以便直观地理解内容结构。

#### 验收标准

1. WHEN 思维导图生成完成 THEN 系统应在画布上渲染完整的树状结构
2. WHEN 用户点击节点 THEN 系统应高亮显示该节点并显示详细信息
3. WHEN 用户拖拽画布 THEN 系统应平滑移动整个思维导图视图
4. WHEN 用户使用鼠标滚轮 THEN 系统应缩放思维导图视图
5. WHEN 用户点击节点的展开/折叠按钮 THEN 系统应切换该节点子节点的显示状态
6. WHEN 思维导图节点数量超过100个 THEN 系统应保持流畅的渲染性能

### 需求 5

**用户故事：** 作为用户，我想要编辑思维导图的内容，以便根据需要调整和完善结构。

#### 验收标准

1. WHEN 用户双击节点 THEN 系统应进入编辑模式并允许修改节点文本
2. WHEN 用户完成编辑并按回车键 THEN 系统应保存修改并退出编辑模式
3. WHEN 用户右键点击节点 THEN 系统应显示上下文菜单，包含添加子节点、删除节点等选项
4. WHEN 用户选择添加子节点 THEN 系统应在当前节点下创建新的空白子节点
5. WHEN 用户选择删除节点 THEN 系统应移除该节点及其所有子节点
6. WHEN 用户拖拽节点 THEN 系统应允许重新组织节点的父子关系

### 需求 6

**用户故事：** 作为用户，我想要导出思维导图，以便在其他应用中使用或分享。

#### 验收标准

1. WHEN 用户点击导出按钮 THEN 系统应显示导出格式选项菜单
2. WHEN 用户选择PNG格式 THEN 系统应将思维导图渲染为PNG图片并触发下载
3. WHEN 用户选择JSON格式 THEN 系统应将思维导图数据序列化为JSON文件并触发下载
4. WHEN 用户选择Markdown格式 THEN 系统应将思维导图转换为层级Markdown文本并触发下载
5. WHEN 导出过程中发生错误 THEN 系统应显示错误消息并保持当前状态

### 需求 7

**用户故事：** 作为用户，我想要保存和加载思维导图，以便继续之前的工作。

#### 验收标准

1. WHEN 用户点击保存按钮 THEN 系统应将当前思维导图数据存储到浏览器本地存储
2. WHEN 用户访问历史记录页面 THEN 系统应显示所有已保存的思维导图列表
3. WHEN 用户点击历史记录中的某个项目 THEN 系统应加载该思维导图并在画布上显示
4. WHEN 用户删除历史记录中的项目 THEN 系统应从本地存储中移除该数据
5. WHEN 本地存储空间不足 THEN 系统应提示用户清理旧数据或导出重要内容

### 需求 8

**用户故事：** 作为用户，我想要使用全中文界面，以便更好地理解和使用系统功能。

#### 验收标准

1. WHEN 用户访问任何页面 THEN 系统应显示中文界面文本
2. WHEN 系统显示错误消息 THEN 系统应使用中文描述错误原因
3. WHEN 系统显示提示信息 THEN 系统应使用中文提供操作指导
4. WHEN 系统显示按钮和菜单 THEN 系统应使用中文标签
5. WHEN 系统显示日期和时间 THEN 系统应使用中文格式（例如：2024年1月1日）

### 需求 9

**用户故事：** 作为用户，我想要系统提供一键生成功能，以便快速从多种输入方式创建思维导图。

#### 验收标准

1. WHEN 用户在主页选择"一键生成"选项 THEN 系统应显示快速生成对话框
2. WHEN 用户在快速生成对话框中输入主题 THEN 系统应接受该主题文本
3. WHEN 用户提交主题 THEN 系统应使用Gemini API基于主题生成思维导图大纲
4. WHEN 用户选择"粘贴文本"选项 THEN 系统应显示文本输入区域
5. WHEN 用户选择"导入文件"选项 THEN 系统应显示文件选择对话框

### 需求 10

**用户故事：** 作为用户，我想要系统响应迅速且稳定，以便获得良好的使用体验。

#### 验收标准

1. WHEN 用户上传小于10MB的文件 THEN 系统应在3秒内完成文件解析
2. WHEN 系统调用Gemini API THEN 系统应显示加载动画指示处理进度
3. WHEN 网络请求超时 THEN 系统应在30秒后取消请求并显示超时错误
4. WHEN 系统渲染思维导图 THEN 系统应保持至少30帧每秒的流畅度
5. WHEN 用户执行任何操作 THEN 系统应在100毫秒内提供视觉反馈
